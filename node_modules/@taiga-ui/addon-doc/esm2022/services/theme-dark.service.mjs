import { inject, Injectable } from '@angular/core';
import { WA_LOCAL_STORAGE, WA_WINDOW } from '@ng-web-apis/common';
import { tuiCreateToken } from '@taiga-ui/cdk/utils/miscellaneous';
import { TUI_DARK_MODE_DEFAULT_KEY, TUI_DARK_MODE_KEY } from '@taiga-ui/core/tokens';
import { BehaviorSubject } from 'rxjs';
import * as i0 from "@angular/core";
/**
 * @deprecated use {@link TUI_DARK_THEME} instead
 */
export const TUI_DARK_THEME_DEFAULT_KEY = TUI_DARK_MODE_DEFAULT_KEY;
/**
 * @deprecated use {@link TUI_DARK_THEME} instead
 */
export const TUI_DARK_THEME_KEY = TUI_DARK_MODE_KEY;
/**
 * @deprecated use {@link TUI_DARK_THEME} instead
 */
export const TUI_DARK_THEME = tuiCreateToken(false);
/**
 * @deprecated use {@link TUI_DARK_THEME} instead
 */
class TuiDocThemeDarkService extends BehaviorSubject {
    constructor() {
        super(isDark(inject(WA_LOCAL_STORAGE), inject(TUI_DARK_THEME_KEY), inject(WA_WINDOW)));
        this.storage = inject(WA_LOCAL_STORAGE);
        this.key = inject(TUI_DARK_THEME_KEY);
    }
    next(dark) {
        this.storage?.setItem(this.key, String(dark));
        super.next(dark);
    }
    toggle() {
        this.next(!this.value);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TuiDocThemeDarkService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TuiDocThemeDarkService, providedIn: 'root' }); }
}
export { TuiDocThemeDarkService };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TuiDocThemeDarkService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root',
                }]
        }], ctorParameters: function () { return []; } });
function isDark(storage, key, window) {
    const fallback = window.matchMedia('(prefers-color-scheme: dark)').matches ||
        inject(TUI_DARK_THEME);
    return (storage?.getItem(key) === 'true' || (storage?.getItem(key) === null && fallback));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhlbWUtZGFyay5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvYWRkb24tZG9jL3NlcnZpY2VzL3RoZW1lLWRhcmsuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsTUFBTSxFQUFFLFVBQVUsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUNqRCxPQUFPLEVBQUMsZ0JBQWdCLEVBQUUsU0FBUyxFQUFDLE1BQU0scUJBQXFCLENBQUM7QUFDaEUsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLG1DQUFtQyxDQUFDO0FBQ2pFLE9BQU8sRUFBQyx5QkFBeUIsRUFBRSxpQkFBaUIsRUFBQyxNQUFNLHVCQUF1QixDQUFDO0FBQ25GLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxNQUFNLENBQUM7O0FBRXJDOztHQUVHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sMEJBQTBCLEdBQUcseUJBQXlCLENBQUM7QUFFcEU7O0dBRUc7QUFDSCxNQUFNLENBQUMsTUFBTSxrQkFBa0IsR0FBRyxpQkFBaUIsQ0FBQztBQUVwRDs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBRyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7QUFFcEQ7O0dBRUc7QUFDSCxNQUdhLHNCQUF1QixTQUFRLGVBQXdCO0lBSWhFO1FBQ0ksS0FBSyxDQUNELE1BQU0sQ0FDRixNQUFNLENBQUMsZ0JBQWdCLENBQUMsRUFDeEIsTUFBTSxDQUFDLGtCQUFrQixDQUFDLEVBQzFCLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FDcEIsQ0FDSixDQUFDO1FBVlcsWUFBTyxHQUFHLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ25DLFFBQUcsR0FBRyxNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQztJQVVsRCxDQUFDO0lBRWUsSUFBSSxDQUFDLElBQWE7UUFDOUIsSUFBSSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUM5QyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3JCLENBQUM7SUFFTSxNQUFNO1FBQ1QsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMzQixDQUFDOytHQXJCUSxzQkFBc0I7bUhBQXRCLHNCQUFzQixjQUZuQixNQUFNOztTQUVULHNCQUFzQjs0RkFBdEIsc0JBQXNCO2tCQUhsQyxVQUFVO21CQUFDO29CQUNSLFVBQVUsRUFBRSxNQUFNO2lCQUNyQjs7QUF5QkQsU0FBUyxNQUFNLENBQUMsT0FBdUIsRUFBRSxHQUFXLEVBQUUsTUFBYztJQUNoRSxNQUFNLFFBQVEsR0FDVixNQUFNLENBQUMsVUFBVSxDQUFDLDhCQUE4QixDQUFDLENBQUMsT0FBTztRQUN6RCxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUM7SUFFM0IsT0FBTyxDQUNILE9BQU8sRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssTUFBTSxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxJQUFJLElBQUksUUFBUSxDQUFDLENBQ25GLENBQUM7QUFDTixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpbmplY3QsIEluamVjdGFibGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtXQV9MT0NBTF9TVE9SQUdFLCBXQV9XSU5ET1d9IGZyb20gJ0BuZy13ZWItYXBpcy9jb21tb24nO1xuaW1wb3J0IHt0dWlDcmVhdGVUb2tlbn0gZnJvbSAnQHRhaWdhLXVpL2Nkay91dGlscy9taXNjZWxsYW5lb3VzJztcbmltcG9ydCB7VFVJX0RBUktfTU9ERV9ERUZBVUxUX0tFWSwgVFVJX0RBUktfTU9ERV9LRVl9IGZyb20gJ0B0YWlnYS11aS9jb3JlL3Rva2Vucyc7XG5pbXBvcnQge0JlaGF2aW9yU3ViamVjdH0gZnJvbSAncnhqcyc7XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgdXNlIHtAbGluayBUVUlfREFSS19USEVNRX0gaW5zdGVhZFxuICovXG5leHBvcnQgY29uc3QgVFVJX0RBUktfVEhFTUVfREVGQVVMVF9LRVkgPSBUVUlfREFSS19NT0RFX0RFRkFVTFRfS0VZO1xuXG4vKipcbiAqIEBkZXByZWNhdGVkIHVzZSB7QGxpbmsgVFVJX0RBUktfVEhFTUV9IGluc3RlYWRcbiAqL1xuZXhwb3J0IGNvbnN0IFRVSV9EQVJLX1RIRU1FX0tFWSA9IFRVSV9EQVJLX01PREVfS0VZO1xuXG4vKipcbiAqIEBkZXByZWNhdGVkIHVzZSB7QGxpbmsgVFVJX0RBUktfVEhFTUV9IGluc3RlYWRcbiAqL1xuZXhwb3J0IGNvbnN0IFRVSV9EQVJLX1RIRU1FID0gdHVpQ3JlYXRlVG9rZW4oZmFsc2UpO1xuXG4vKipcbiAqIEBkZXByZWNhdGVkIHVzZSB7QGxpbmsgVFVJX0RBUktfVEhFTUV9IGluc3RlYWRcbiAqL1xuQEluamVjdGFibGUoe1xuICAgIHByb3ZpZGVkSW46ICdyb290Jyxcbn0pXG5leHBvcnQgY2xhc3MgVHVpRG9jVGhlbWVEYXJrU2VydmljZSBleHRlbmRzIEJlaGF2aW9yU3ViamVjdDxib29sZWFuPiB7XG4gICAgcHJpdmF0ZSByZWFkb25seSBzdG9yYWdlID0gaW5qZWN0KFdBX0xPQ0FMX1NUT1JBR0UpO1xuICAgIHByaXZhdGUgcmVhZG9ubHkga2V5ID0gaW5qZWN0KFRVSV9EQVJLX1RIRU1FX0tFWSk7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoXG4gICAgICAgICAgICBpc0RhcmsoXG4gICAgICAgICAgICAgICAgaW5qZWN0KFdBX0xPQ0FMX1NUT1JBR0UpLFxuICAgICAgICAgICAgICAgIGluamVjdChUVUlfREFSS19USEVNRV9LRVkpLFxuICAgICAgICAgICAgICAgIGluamVjdChXQV9XSU5ET1cpLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgb3ZlcnJpZGUgbmV4dChkYXJrOiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RvcmFnZT8uc2V0SXRlbSh0aGlzLmtleSwgU3RyaW5nKGRhcmspKTtcbiAgICAgICAgc3VwZXIubmV4dChkYXJrKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdG9nZ2xlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLm5leHQoIXRoaXMudmFsdWUpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gaXNEYXJrKHN0b3JhZ2U6IFN0b3JhZ2UgfCBudWxsLCBrZXk6IHN0cmluZywgd2luZG93OiBXaW5kb3cpOiBib29sZWFuIHtcbiAgICBjb25zdCBmYWxsYmFjayA9XG4gICAgICAgIHdpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJykubWF0Y2hlcyB8fFxuICAgICAgICBpbmplY3QoVFVJX0RBUktfVEhFTUUpO1xuXG4gICAgcmV0dXJuIChcbiAgICAgICAgc3RvcmFnZT8uZ2V0SXRlbShrZXkpID09PSAndHJ1ZScgfHwgKHN0b3JhZ2U/LmdldEl0ZW0oa2V5KSA9PT0gbnVsbCAmJiBmYWxsYmFjaylcbiAgICApO1xufVxuIl19